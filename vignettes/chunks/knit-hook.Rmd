```{r}
old.hook <- knitr::knit_hooks$get("output")
new.hook <- function(x, options){
  # If the output has SGR in it, then convert to HTML and wrap
  # in PRE/CODE tags

  if(any(fansi::has_sgr(x))) {
    fansi::html_code_block(fansi::sgr_to_html(x))
  }
  # If output doesn't have SGR, then use the default hook

  else old.hook(x, options)
}
knitr::knit_hooks$set(output = new.hook)
```
